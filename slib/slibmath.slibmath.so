module slibmath

// ğŸ”¢ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
method add(float a, float b) => a + b;
method sub(float a, float b) => a - b;
method mul(float a, float b) => a * b;
method div(float a, float b) => b == 0 ? null : a / b;

// ğŸ“ Ø¯ÙˆØ§Ù„ Ù‡Ù†Ø¯Ø³ÙŠØ©
method distance(float x1, float y1, float x2, float y2) {
  return sqrt(pow(x2 - x1, 2) + pow(y2 - y1, 2));
}

method angle(float x1, float y1, float x2, float y2) {
  return atan2(y2 - y1, x2 - x1);
}

method rotate(float x, float y, float theta) {
  float cosT = cos(theta);
  float sinT = sin(theta);
  return [x * cosT - y * sinT, x * sinT + y * cosT];
}

// ğŸ“Š Ø¯ÙˆØ§Ù„ Ø¥Ø­ØµØ§Ø¦ÙŠØ©
method average(list<float> values) {
  if (values.length() == 0) return 0;
  float sum = 0;
  foreach (v in values) sum += v;
  return sum / values.length();
}

method variance(list<float> values) {
  float avg = average(values);
  float v = 0;
  foreach (x in values) v += pow(x - avg, 2);
  return v / values.length();
}

method stddev(list<float> values) => sqrt(variance(values));

method max(list<float> values) {
  float m = values[0];
  foreach (x in values) if (x > m) m = x;
  return m;
}

method min(list<float> values) {
  float m = values[0];
  foreach (x in values) if (x < m) m = x;
  return m;
}

// ğŸ§  Ø¯ÙˆØ§Ù„ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ØµØºÙ‘Ø±Ø©
method sigmoid(float x) => 1 / (1 + exp(-x));
method relu(float x) => x < 0 ? 0 : x;

method normalize(float value, float min, float max) {
  if (max - min == 0) return 0;
  return (value - min) / (max - min);
}

method classify(float score) {
  if (score < 0.3) return "ğŸš« Ø¶Ø¹ÙŠÙ";
  else if (score < 0.7) return "ğŸŸ¡ Ù…ØªÙˆØ³Ø·";
  else return "âœ… Ù‚ÙˆÙŠ";
}

// ğŸ“ˆ Ø¯Ø¹Ù… Ø¨ÙŠØ§Ù†ÙŠ ÙˆØ±ÙŠØ§Ø¶ÙŠ Ø¥Ø¶Ø§ÙÙŠ
method lerp(float a, float b, float t) => a + (b - a) * t;
method scale(float x, float inMin, float inMax, float outMin, float outMax) {
  return (x - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;
}

method isPositive(float x) => x > 0;
method isNegative(float x) => x < 0;
method isZero(float x) => x == 0;

// ğŸ¯ Ø£Ø±Ù‚Ø§Ù… Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
method randFloat(float min, float max) {
  float r = shell.exec("echo $RANDOM") / 32767.0;
  return min + (max - min) * r;
}

method randInt(int min, int max) {
  int r = shell.exec("echo $RANDOM") % (max - min + 1);
  return r + min;
}

// ğŸ” ÙØ­Øµ ÙˆØªØ­Ù„ÙŠÙ„
method withinRange(float x, float min, float max) {
  return x >= min && x <= max;
}

method percent(float part, float whole) {
  if (whole == 0) return 0;
  return (part / whole) * 100;
}
