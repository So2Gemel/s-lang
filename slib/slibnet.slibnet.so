
module slibnet

// ğŸŒ Ø·Ù„Ø¨Ø§Øª HTTP Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
method get(string url) => shell.exec("curl -s " + url);

method post(string url, map<string, string> data) {
  string body = "";
  foreach (k in data.keys()) {
    body += k + "=" + data[k] + "&";
  }
  return shell.exec("curl -s -X POST -d '" + body + "' " + url);
}

// ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
method download(string url, string outPath = "download.bin") {
  shell.exec("curl -o " + outPath + " " + url);
  return outPath;
}

// ğŸ“¡ ÙØ­Øµ Ø§Ù„Ø´Ø¨ÙƒØ©: Ping ÙˆØ§Ø®ØªØ¨Ø§Ø± Ø§ØªØµØ§Ù„
method ping(string host) => shell.exec("ping -c 1 " + host);
method isOnline(string url = "https://google.com") {
  string res = shell.exec("curl -s --head " + url + " | grep HTTP");
  return res.contains("200 OK") || res.contains("302 Found");
}

// ğŸ”‘ ØªØ®ØµÙŠØµ Ø±Ø¤ÙˆØ³ HTTP
method getWithHeaders(string url, map<string, string> headers) {
  string headerStr = "";
  foreach (k in headers.keys()) {
    headerStr += "-H \"" + k + ": " + headers[k] + "\" ";
  }
  return shell.exec("curl -s " + headerStr + url);
}

// ğŸ” Ø¯Ø¹Ù… WebSocket Ø§Ù„Ø£ÙˆÙ„ÙŠ (ØªØ¬Ø±ÙŠØ¨ÙŠ)
method wsConnect(string host, int port) {
  return shell.exec("websocat ws://" + host + ":" + port);
}

// ğŸ§¾ ØªØ­Ù„ÙŠÙ„ HTTP
method getHeaders(string url) {
  return shell.exec("curl -sI " + url);
}

method getStatusCode(string url) {
  string res = shell.exec("curl -s -o /dev/null -w '%{http_code}' " + url);
  return int(res);
}

// ğŸ•µï¸ ÙØ­Øµ DNS Ùˆ IP
method getIP(string domain) => shell.exec("ping -c 1 " + domain + " | grep PING").split(" ")[2].replace("(", "").replace(")", "");
method resolveDNS(string domain) => shell.exec("nslookup " + domain);

// ğŸ§  Ø¯Ø¹Ù… JSON ÙÙŠ Ø§Ù„Ø±Ø¯ÙˆØ¯ (ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… jsoncpp)
method getJSON(string url) {
  string raw = shell.exec("curl -s " + url);
  return jsoncpp.parse(raw); // ÙÙŠ Ø­Ø§Ù„ jsoncpp Ù…Ø«Ø¨ØªØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨ÙŠØ¦Ø©
}
